import React from 'react';
import { db } from '../firebase.config'; // –í–∞—à —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Firebase
import { collection, addDoc, serverTimestamp } from 'firebase/firestore';

const EXAMPLE_BOOK_DATA = {
  addedBy: "–ê–¥–º—ñ–Ω",
  addedById: "creator",
  author: "–ê–≤—Ç–æ—Ä –ø—ñ–∑–¥–∞–±–æ–ª",
  characters: [
    "–ö—ñ—Ç",
    "–ü–µ—Å",
    "–©—É—Ä",
    "–£ —á–æ–º—É –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è —è –¥–æ—Å—ñ –Ω–µ –∑—Ä–æ–∑—É–º—ñ–ª–∞",
    "–ö—ñ–Ω–µ—Ü—å"
  ],
  colorHue: "4A90E2",
  createdAt: serverTimestamp(), // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ serverTimestamp() –¥–ª—è Firebase
  description: "–û—Ñ—ñ–≥—ñ—Ç—ñ—Ç—î–ª—å–Ω–∞ –∫–Ω–∏–≥–∞ —è–∫—É –≤–∞—Ä—Ç–æ —è–∫ –∑–∞–∂–¥–∏ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ - –±–æ —è–∫—â–æ –Ω–µ –ø—Ä–æ—á–∏—Ç–∞—î —Ç–æ —Ç–∏ –ª–æ—Ö –ø–µ–¥–∞–ª—å–Ω–∏–π. –ö–æ–º–±—ñ–Ω–∞—Ü—ñ—è –∂–∞—Ö—É —Ç—Ä–∏–ª–µ—Ä—É —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∏ 18+ —ñ —â–µ + 20 –∂–∞–Ω—Ä—ñ–≤ –Ω–µ–≤—ñ–¥–æ–º–∏—Ö –ª—é–¥—Å—Ç–≤—É, —è–∫—ñ –Ω–∞–≤—ñ—Ç—å –Ω–µ —ñ—Å–Ω—É—é—Ç—å —É –Ω–∞—à—ñ–π –ë–∞–∑—ñ –¥–∞–Ω–∏—Ö - –ø—Ä–æ—Å—Ç–µ —Ü–µ –ø—Ä–∏—á–∏–Ω–∞ —â–æ–± –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Å–∞–º–µ —Ü—é –∫–Ω–∏–∂–∫—É! –£–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å —Ç–∞–∫–æ–∂ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É - —â–æ –•–£–ô –≤–∞–º –∞ –Ω–µ –∫–Ω–∏–∂–∫–∞ - –∞–¥–∂–µ –Ω–∞—à—ñ –∫–Ω–∏–≥–∏ –Ω–µ–º–æ–∂–ª–∏–≤–æ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –æ–Ω–ª–∞–π–Ω) –õ–∏—à–µ –ø—ñ–¥–Ω—è–≤—à–∏ —Å–≤–æ—é –∂–æ–ø—É —Ç–∞ –∫—É–ø—É—é—á–∏ —É –º–∞–≥–∞–∑–∏–Ω—ñ, –Ω—É –∞–±–æ –¥–ª—è –æ—Å–æ–±–ª–∏–≤–æ –ª—ñ–Ω–∏–≤–∏—Ö —è–∫ —è –∂–æ–ø - –∑–∞–º–æ–≤–∏—Ç–∏ —Å–æ–±—ñ –∑ –¥–æ—Å—Ç–∞–≤–∫–æ—é. –ê —è–∫—â–æ –≤–∏ –∂–º–æ—Ç (–≤–ø—Ä–∏–Ω—Ü–∏–ø—ñ —è–∫ —ñ —è - –ø–æ—à—É–∫–∞–π—Ç–µ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ –±–ª—è—Ö–∞).",
  genres: [
    "ySUHRE8hSsd1gXK1o2SV",
    "thriller",
    "horror",
    "romantic_prose",
    "2GmFPOJBhciuYIeKcqSt"
  ],
  imagePath: "https://firebasestorage.googleapis.com/v0/b/bookslibrary-1c8ed.firebasestorage.app/o/book_covers%2F1758834799476_znak%20zaputannia.jpeg?alt=media&token=4f2ef6da-cb84-40e7-bfed-5c5a0b70323a",
  language: "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞",
  opinion: "–û–ø–∏—Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç - –º–∞–±—É–¥—å —Ü–µ –¥—É–∂–µ –∑–∞—Ö–æ–ø–ª–∏–≤–∞ –∫–Ω–∏–≥–∞ –∞–ª–µ —è —Ö–∑ —è–∫–∏–π —Ç—É—Ç –æ–ø–∏—Å) –ë–æ –≤–ª–∞—Å–Ω–∏—Ü—è —Å–∞–π—Ç—É –¥–æ—Å—ñ –Ω–µ –æ–Ω–æ–≤–∏–ª–∞ –Ω—ñ—á–æ–≥–æ - –ø—Ä–æ—Å—Ç–æ –ø—É—Å—Ç–æ—Ç–∞ 0_0. –¢–æ–º—É —è –º–æ–∂—É —Ä–æ–∑–ø–æ–≤—ñ—Å—Ç–∏ —Å–º—ñ—à–Ω–∏–π –∂–∞—Ä—Ç.... –ö–æ–ª–æ–±–æ–∫ –ø–æ–≤—ñ—Å–∏–≤—Å—è! –ù–µ —Å–º—ñ—à–Ω–æ —è –∑–Ω–∞—é, —Ç–æ–º—É '–∫–∞—Ä–æ—á–µ –≤–æ–ø—à—ñ–º –¥–∞' - —Ñ—ñ–≥–æ–≤–∏–π –∑ –º–µ–Ω–µ –∫–ª–æ—É–Ω. –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ—Ç–µ –±–∞–≥ –∞–±–æ —â–æ—Å—å –≤–∞–º –Ω–µ –ø–æ–¥–æ–±–∞—î—Ç—å—Å—è - –π–¥—ñ—Ç—å –Ω–∞—Ñ—ñ–≥ –∫–æ—Ä–æ—Ç—à–µ, —è —Ç–æ–∫—Å—ñ–∫. –¶–µ –æ—Ñ—ñ–≥–µ–∑–Ω–∏–π —Å–∞–π—Ç! –ù—É –ª–∞–¥–Ω–æ.. –Ω–∞–ø–∏—à—ñ—Ç—å –º–µ–Ω—ñ –≤ —Ç–≥ @tyshorealnotypuj?. –õ—é —É—Å—ñ—Ö —Ö—Ç–æ –ø—Ä–æ—á–∏—Ç–∞–≤ —Ü–µ–π –±—Ä—î–¥ –¥–æ –∫—ñ–Ω—Ü—è üíñ",
  pages: 666,
  publisher: "–ê–±—Ä–∞–∫–∞–¥–∞–±—Ä–∞",
  size: {
    height: 24,
    id: "wide-short",
    width: 9
  },
  title: "–¢–µ—Å—Ç–æ–≤–∞ –∫–Ω–∏–≥–∞",
  year: 2025
};


const AddExampleBookButton = () => {
  const [loading, setLoading] = React.useState(false);
  const [message, setMessage] = React.useState('');

  const addExampleBook = async () => {
    setLoading(true);
    setMessage('');
    try {
      // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ–ª–µ–∫—Ü—ñ—é "books"
      const docRef = await addDoc(collection(db, "books"), EXAMPLE_BOOK_DATA);
      
      setMessage(`‚úÖ –ö–Ω–∏–≥—É —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ! ID: ${docRef.id}`);
    } catch (e) {
      console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞: ", e);
      setMessage(`‚ùå –ü–æ–º–∏–ª–∫–∞: ${e.message}`);
    } finally {
      setLoading(false);
      // –û—á–∏—â–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥
      setTimeout(() => setMessage(''), 5000); 
    }
  };

  return (
    <div className="flex flex-col items-start gap-2 p-4">
      {/* –ö–Ω–æ–ø–∫–∞ */}
      <button
        onClick={addExampleBook}
        disabled={loading}
        className="bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-4 rounded transition duration-200 disabled:opacity-50"
      >
        {loading ? '–î–æ–¥–∞—î—Ç—å—Å—è...' : '‚ûï –î–æ–¥–∞—Ç–∏ –¢–µ—Å—Ç–æ–≤—É –ö–Ω–∏–≥—É'}
      </button>

      {/* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Å—Ç–∞—Ç—É—Å */}
      {message && (
        <p className={`text-sm ${message.startsWith('‚ùå') ? 'text-red-600' : 'text-green-600'}`}>
          {message}
        </p>
      )}
    </div>
  );
};

export default AddExampleBookButton;